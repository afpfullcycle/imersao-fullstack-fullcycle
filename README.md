<p align="center">
    <img src="https://events-fullcycle.s3.amazonaws.com/events-fullcycle/static/site/img/grupo_4417.png" />
</p>

# Aulas Imersão FullStack FullCycle

## Aula 3

### Apache Kafka e sua exigência no mercado

```shell
code ~/projects/imersao-fsfc/codepix/
git checkout -b aula3
docker rm $(docker ps -aq) -f
docker-compose up -d
docker-compose ps -a
docker exec -it codepix_app_1 bash
go run main.go
cobra add kafka
go run main.go kafka
mkdir -p ./application/{kafka,model,factory}
touch ./application/kafka/{producer,process}.go ./application/model/transaction.go ./application/factory/factory.go
```

- ./cmd/kafka.go
    - Generated by cobra add command
    - Imported os, application/kafka, infrastructure/db, confluent-kafka and cobra"
    - Adjusted variable kafkaCmd

- ./application/kafka/producer.go
    - Imported fmt, os and confluent-kafka
    - Created functions NewKafkaProducer, Publish and DeliveryReport

```browser
http://localhost:9021
    >> Added a new test topic
```

```shell
docker-compose ps -a
docker exec -it codepix_kafka_1 bash
kafka-topics --list --bootstrap-server=localhost:9092
kafka-console-consumer --topic=teste --bootstrap-server=localhost:9092
```

```shell
docker exec -it codepix_app_1 bash
go run main.go kafka
```

- ./application/factory/factory.go
    - Imported application/usecase, infrastructure/repository and gorm
    - Created function TransactionUseCaseFactory

- ./infrastructure/repository/transaction.go
    - Adjusted import gorm

- ./application/model/transaction.go
    - Imported encoding/json, fmt and validator
    - Created struct Transaction
    - Created methods isValid, ParseJson and ToJson
    - Created function NewTransaction

- ./application/kafka/process.go
    - Import fmt, application/factory, application/model, application/usecase, domain/model, confluent-kafka, gorm and os
    - Created struct KafkaProcessor
    - Created function NewKafkaProcessor
    - Created methods Consume, processMessage, processTransaction, processTransactionConfirmation and confirmTransaction

- .env
    - Added kafka environment variable

```shell
cobra add all
```

- ./cmd/all.go
    - Generated by cobra add command
    - Imported os, application/grpc, application/kafka, infrastructure/db, confluent-kafka and cobra
    - Adjusted variable allCmd and function init

```shell
go run main.go all
```
